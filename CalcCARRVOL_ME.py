# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# CalcCARRVOL_ME.py
# Created on: 2015-09-18 09:45:15.00000
#   (generated by ArcGIS/ModelBuilder)
# Description: 
# ---------------------------------------------------------------------------

# Set the necessary product code
# import arcinfo


# Import arcpy module
import arcpy

# Set Geoprocessing environments
arcpy.env.workspace = "\\\\GGP-SFO-FILE01\\USER$\\mnorelli\\My Documents\\ArcGIS\\Default.gdb"


# Local variables:
OccurTr4new = "OccurTr4new"
Polygon_OccurTrt = "Polygon_OccurTrt"
work = "O:\\gis_projects\\_Marin\\EPMT_2015_Process20150917\\PICO_COJU_8-25-2015"
mergepolypoint_shp = "%work%\\mergepolypoint.shp"
sumDENSITY_dbf = "%work%\\sumDENSITY.dbf"
polypoints_shp = "%work%\\polypoints.shp"
result = "OccurTr4new"
OccurTre1 = "OccurTr4new"
result__2_ = "Polygon_OccurTrt"
OccurTre1__2_ = "Polygon_OccurTrt"

# Process: Feature To Point
arcpy.FeatureToPoint_management(Polygon_OccurTrt, polypoints_shp, "CENTROID")

# Process: Merge
arcpy.Merge_management("%work%\\polypoints.shp;OccurTr4new", mergepolypoint_shp, "SNAME \"SNAME\" true true false 60 Text 0 0 ,First,#,OccurTr4new,SNAME,-1,-1;EARLY_DETE \"EARLY_DETE\" true true false 60 Text 0 0 ,First,#,OccurTr4new,EARLY_DETE,-1,-1;OLDNEW \"OLDNEW\" true true false 60 Text 0 0 ,First,#,OccurTr4new,OLDNEW,-1,-1;PHENO \"PHENO\" true true false 60 Text 0 0 ,First,#,OccurTr4new,PHENO,-1,-1;OFFSET \"OFFSET\" true true false 60 Text 0 0 ,First,#,OccurTr4new,OFFSET,-1,-1;OFFSET_M \"OFFSET_M\" true true false 10 Double 2 9 ,First,#,OccurTr4new,OFFSET_M,-1,-1;OFFSET_AZ \"OFFSET_AZ\" true true false 8 Float 2 7 ,First,#,OccurTr4new,OFFSET_AZ,-1,-1;SQ_METERS \"SQ_METERS\" true true false 10 Double 2 9 ,First,#,OccurTr4new,SQ_METERS,-1,-1;LENGTH \"LENGTH\" true true false 10 Double 2 9 ,First,#,OccurTr4new,LENGTH,-1,-1;WIDTH \"WIDTH\" true true false 10 Double 2 9 ,First,#,OccurTr4new,WIDTH,-1,-1;COVERCLS \"COVERCLS\" true true false 60 Text 0 0 ,First,#,OccurTr4new,COVERCLS,-1,-1;PCTTREATED \"PCTTREATED\" true true false 60 Text 0 0 ,First,#,OccurTr4new,PCTTREATED,-1,-1;PLANTSA \"PLANTSA\" true true false 5 Long 0 5 ,First,#,OccurTr4new,PLANTSA,-1,-1;TREAT_PLAN \"TREAT_PLAN\" true true false 20 Text 0 0 ,First,#,OccurTr4new,TREAT_PLAN,-1,-1;NOTES \"NOTES\" true true false 230 Text 0 0 ,First,#,OccurTr4new,NOTES,-1,-1;Max_PDOP \"Max_PDOP\" true true false 6 Float 1 5 ,First,#,OccurTr4new,Max_PDOP,-1,-1;Max_HDOP \"Max_HDOP\" true true false 6 Float 1 5 ,First,#,OccurTr4new,Max_HDOP,-1,-1;Corr_Type \"Corr_Type\" true true false 36 Text 0 0 ,First,#,OccurTr4new,Corr_Type,-1,-1;Rcvr_Type \"Rcvr_Type\" true true false 36 Text 0 0 ,First,#,OccurTr4new,Rcvr_Type,-1,-1;GPS_Date \"GPS_Date\" true true false 8 Date 0 0 ,First,#,OccurTr4new,GPS_Date,-1,-1;GPS_Time \"GPS_Time\" true true false 10 Text 0 0 ,First,#,OccurTr4new,GPS_Time,-1,-1;Update_Sta \"Update_Sta\" true true false 36 Text 0 0 ,First,#,OccurTr4new,Update_Sta,-1,-1;Feat_Name \"Feat_Name\" true true false 20 Text 0 0 ,First,#,OccurTr4new,Feat_Name,-1,-1;Datafile \"Datafile\" true true false 20 Text 0 0 ,First,#,OccurTr4new,Datafile,-1,-1;Unfilt_Pos \"Unfilt_Pos\" true true false 10 Double 0 10 ,First,#,OccurTr4new,Unfilt_Pos,-1,-1;Filt_Pos \"Filt_Pos\" true true false 10 Double 0 10 ,First,#,OccurTr4new,Filt_Pos,-1,-1;Data_Dicti \"Data_Dicti\" true true false 20 Text 0 0 ,First,#,OccurTr4new,Data_Dicti,-1,-1;GPS_Week \"GPS_Week\" true true false 6 Long 0 6 ,First,#,OccurTr4new,GPS_Week,-1,-1;GPS_Second \"GPS_Second\" true true false 15 Double 3 14 ,First,#,OccurTr4new,GPS_Second,-1,-1;GNSS_Heigh \"GNSS_Heigh\" true true false 19 Double 3 18 ,First,#,OccurTr4new,GNSS_Heigh,-1,-1;Vert_Prec \"Vert_Prec\" true true false 17 Double 1 16 ,First,#,OccurTr4new,Vert_Prec,-1,-1;Horz_Prec \"Horz_Prec\" true true false 17 Double 1 16 ,First,#,OccurTr4new,Horz_Prec,-1,-1;Std_Dev \"Std_Dev\" true true false 19 Double 6 18 ,First,#,OccurTr4new,Std_Dev,-1,-1;Northing \"Northing\" true true false 19 Double 3 18 ,First,#,OccurTr4new,Northing,-1,-1;Easting \"Easting\" true true false 19 Double 3 18 ,First,#,OccurTr4new,Easting,-1,-1;Point_ID \"Point_ID\" true true false 9 Long 0 9 ,First,#,OccurTr4new,Point_ID,-1,-1;Folder \"Folder\" true true false 50 Text 0 0 ,First,#,OccurTr4new,Folder,-1,-1;Recorder \"Recorder\" true true false 60 Text 0 0 ,First,#,OccurTr4new,Recorder,-1,-1;Workgroup \"Workgroup\" true true false 60 Text 0 0 ,First,#,OccurTr4new,Workgroup,-1,-1;Workgroup2 \"Workgroup2\" true true false 60 Text 0 0 ,First,#,OccurTr4new,Workgroup2,-1,-1;Work_Desc \"Work_Desc\" true true false 230 Text 0 0 ,First,#,OccurTr4new,Work_Desc,-1,-1;TREAT_TYPE \"TREAT_TYPE\" true true false 60 Text 0 0 ,First,#,OccurTr4new,TREAT_TYPE,-1,-1;TRADE_NM \"TRADE_NM\" true true false 60 Text 0 0 ,First,#,OccurTr4new,TRADE_NM,-1,-1;AGT_APP_RT \"AGT_APP_RT\" true true false 8 Float 2 7 ,First,#,OccurTr4new,AGT_APP_RT,-1,-1;ADJ_TRADE_ \"ADJ_TRADE_\" true true false 60 Text 0 0 ,First,#,OccurTr4new,ADJ_TRADE_,-1,-1;ADJ_AGT_AP \"ADJ_AGT_AP\" true true false 8 Float 2 7 ,First,#,OccurTr4new,ADJ_AGT_AP,-1,-1;Total_USED \"Total_USED\" true true false 10 Double 2 9 ,First,#,OccurTr4new,Total_USED,-1,-1;TREAT \"TREAT\" true true false 1 Text 0 0 ,First,#,OccurTr4new,TREAT,-1,-1;COVERCALC \"COVERCALC\" true true false 19 Double 0 0 ,First,#,OccurTr4new,COVERCALC,-1,-1;DENSITY \"DENSITY\" true true false 19 Double 0 0 ,First,#,OccurTr4new,DENSITY,-1,-1;SUMDENSITY \"SUMDENSITY\" true true false 19 Double 0 0 ,First,#,OccurTr4new,SUMDENSITY,-1,-1;CARRVOL_ME \"CARRVOL_ME\" true true false 19 Double 0 0 ,First,#,OccurTr4new,CARRVOL_ME,-1,-1;COUNTPLANT \"COUNTPLANT\" true true false 3 Text 0 0 ,First,#,OccurTr4new,COUNTPLANT,-1,-1;ORIG_FID \"ORIG_FID\" true true false 0 Long 0 0 ,First,#,%work%\\polypoints.shp,ORIG_FID,-1,-1")

# Process: Summary Statistics (3)
arcpy.Statistics_analysis(mergepolypoint_shp, sumDENSITY_dbf, "DENSITY SUM", "TREAT_PLAN")

# Process: Join Field
arcpy.JoinField_management(OccurTr4new, "TREAT_PLAN", sumDENSITY_dbf, "TREAT_PLAN", "SUM_DENSIT")

# Process: Calculate Field
arcpy.CalculateField_management(result, "SUMDENSITY", "[SUM_DENSIT]", "VB", "")

# Process: CARRVOL_ME
arcpy.CalculateField_management(OccurTre1, "CARRVOL_ME", "round([Total_USED]*( [DENSITY]/ [SUMDENSITY]),2)", "VB", "")

# Process: Join Field (2)
arcpy.JoinField_management(Polygon_OccurTrt, "TREAT_PLAN", sumDENSITY_dbf, "TREAT_PLAN", "SUM_DENSIT")

# Process: Calculate Field (2)
arcpy.CalculateField_management(result__2_, "SUMDENSITY", "[SUM_DENSIT]", "VB", "")

# Process: CARRVOL_ME (2)
arcpy.CalculateField_management(OccurTre1__2_, "CARRVOL_ME", "round([Total_USED]*( [DENSITY]/ [SUMDENSITY]),2)", "VB", "")

